<Page
    x:Class="Modrix.Views.Pages.DashboardPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:Modrix.Views.Pages"
    xmlns:controls="clr-namespace:Modrix.Views.Controls"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    Title="DashboardPage"
    d:DataContext="{d:DesignInstance local:DashboardPage,
                                     IsDesignTimeCreatable=False}"
    d:DesignHeight="450"
    d:DesignWidth="800"
    ui:Design.Background="{DynamicResource ApplicationBackgroundBrush}"
    ui:Design.Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    mc:Ignorable="d">

    <Grid>
        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="24">
                <!-- Header with Refresh Button -->
                <Grid Margin="0,0,0,16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock
                        Grid.Column="0"
                        Text="Your Projects"
                        FontSize="24"
                        FontWeight="Medium"/>

                    <ui:Button
                        Grid.Column="2"
                        Appearance="Light"
                        Icon="{ui:SymbolIcon Folder24}"
                        Command="{Binding ViewModel.OpenProjectsFolderCommand}"
                        Width="40"
                        Height="40"
                        Margin="0,0,8,0"
                        ToolTip="Open Projects Folder"/>

                    <ui:Button
                        Grid.Column="3"
                        Appearance="Light"
                        Icon="{ui:SymbolIcon ArrowClockwise24}"
                        Command="{Binding ViewModel.RefreshProjectsCommand}"
                        Width="40"
                        Height="40"
                        ToolTip="Refresh Projects List"/>
                </Grid>



                <ItemsControl ItemsSource="{Binding ViewModel.Projects}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel 
                                Orientation="Horizontal" 
                                HorizontalAlignment="Left"/>
                            
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <controls:ProjectCard 
                                ProjectData="{Binding}" 
                                Margin="6,0,6,12"
                                EditClicked="ProjectCard_EditClicked"
                                DeleteClicked="ProjectCard_DeleteClicked"
                                OpenFolderClicked="ProjectCard_OpenFolderClicked"/>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>


                <!-- Empty state message -->
                <TextBlock 
                    Text="No projects yet. Click the + button to create a new project."
                    HorizontalAlignment="Center"
                    Margin="0,32,0,0"
                    Foreground="{DynamicResource TextFillColorSecondaryBrush}">
                    <TextBlock.Style>
                        <Style TargetType="TextBlock">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ViewModel.Projects.Count}" Value="0">
                                    <Setter Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>

            </StackPanel>
        </ScrollViewer>

        <!-- Add New Project FAB -->
        <ui:Button
            Appearance="Primary"
            Icon="{ui:SymbolIcon Add24}"
            Width="48"
            Height="48"
            VerticalAlignment="Bottom"
            HorizontalAlignment="Right"
            Margin="0,0,24,24"
            Command="{Binding ViewModel.CreateNewProjectCommand}"
            ToolTip="Create New Project"/>
    </Grid>
</Page>