<Page
    x:Class="Modrix.Views.Pages.TextureEditorPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="clr-namespace:Modrix.Views.Pages"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    Title="Texture Editor"
    d:DataContext="{d:DesignInstance Type=local:TextureEditorPage, IsDesignTimeCreatable=False}"
    d:DesignHeight="650"
    d:DesignWidth="800"
    ui:Design.Background="{DynamicResource ApplicationBackgroundBrush}"
    ui:Design.Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    Foreground="{DynamicResource TextFillColorPrimaryBrush}"
    mc:Ignorable="d">

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Header -->
        <Grid Grid.Row="0" Margin="0,0,0,12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0">
                <TextBlock
                    FontSize="20"
                    FontWeight="Medium"
                    Text="{Binding ViewModel.FileName}" />
                <TextBlock
                    Margin="0,4,0,0"
                    Foreground="{DynamicResource TextFillColorTertiaryBrush}"
                    TextWrapping="Wrap">
                    <Run Text="Size: " />
                    <Run Text="{Binding ViewModel.ImageWidth, Mode=OneWay}" />
                    <Run Text=" x " />
                    <Run Text="{Binding ViewModel.ImageHeight, Mode=OneWay}" />
                    <Run Text=" pixels" />
                </TextBlock>
            </StackPanel>

            <StackPanel
                Grid.Column="1"
                Margin="12,0,0,0"
                Orientation="Horizontal">
                <ui:Button
                    Margin="0,0,8,0"
                    Appearance="Primary"
                    Command="{Binding ViewModel.SaveCommand}"
                    Icon="Save24">
                    Save
                </ui:Button>
            </StackPanel>
        </Grid>

        <!-- Main Content -->
        <Grid Grid.Row="1">
            <Border
                Padding="2"
                Background="{DynamicResource ControlFillColorDefaultBrush}"
                CornerRadius="8">
                <ScrollViewer
                    HorizontalScrollBarVisibility="Auto"
                    VerticalScrollBarVisibility="Auto">
                    <Grid>
                        <!-- Checkerboard Background -->
                        <Rectangle>
                            <Rectangle.Fill>
                                <DrawingBrush
                                    TileMode="Tile"
                                    Viewport="0,0,16,16"
                                    ViewportUnits="Absolute">
                                    <DrawingBrush.Drawing>
                                        <DrawingGroup>
                                            <GeometryDrawing Brush="#FFF5F5F5">
                                                <GeometryDrawing.Geometry>
                                                    <RectangleGeometry Rect="0,0,16,16" />
                                                </GeometryDrawing.Geometry>
                                            </GeometryDrawing>
                                            <GeometryDrawing Brush="#FFE5E5E5">
                                                <GeometryDrawing.Geometry>
                                                    <GeometryGroup>
                                                        <RectangleGeometry Rect="0,0,8,8" />
                                                        <RectangleGeometry Rect="8,8,8,8" />
                                                    </GeometryGroup>
                                                </GeometryDrawing.Geometry>
                                            </GeometryDrawing>
                                        </DrawingGroup>
                                    </DrawingBrush.Drawing>
                                </DrawingBrush>
                            </Rectangle.Fill>
                        </Rectangle>

                        <!-- Image -->
                        <Image
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            RenderOptions.BitmapScalingMode="NearestNeighbor"
                            Source="{Binding ViewModel.CurrentImage}"
                            Stretch="None" />
                    </Grid>
                </ScrollViewer>
            </Border>
        </Grid>

        <!-- Footer -->
        <ui:Card
            Grid.Row="2"
            Margin="0,8,0,0"
            Padding="8">
            <TextBlock>
                <Run Text="{Binding ViewModel.FileName}" />
                <Run Text=" - " />
                <Run Text="{Binding ViewModel.ImageWidth, Mode=OneWay}" />
                <Run Text=" x " />
                <Run Text="{Binding ViewModel.ImageHeight, Mode=OneWay}" />
                <Run Text=" pixels" />
            </TextBlock>
        </ui:Card>
    </Grid>
</Page>